<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="加意新品(jiae.com)是一种创意的生活方式，让每个人享受设计的乐趣，每天加一点创意。 对于消费者，你可以抢鲜购买到原创的设计精品，也可以找到设计师为你提供专属的创意设计服务。 对于设计师，你可以免费发布设计新品和设计服务，帮助你自由实现设计梦想。">
    <meta name="keywords" content="创意电商、新品电商、创意产品、创意家居、创意设计、创意礼物、创意生活、设计师、极客">
    <meta name="viewport" content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no,minimal-ui">
    <title>加意新品</title>
    <!-- Set render engine for 360 browser -->
    <meta name="renderer" content="webkit">
    <!-- No Baidu Siteapp-->
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="shortcut icon" href="../assets/i/favicon.ico">
    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" sizes="192x192" href="../assets/i/app-icon72x72@2x.png">
    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Amaze UI" />
    <link rel="apple-touch-icon-precomposed" href="../assets/i/app-icon72x72@2x.png">
    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="../assets/i/app-icon72x72@2x.png">
    <meta name="msapplication-TileColor" content="#0e90d2">
    <link rel="stylesheet" href="../assets/css/amazeui.min.css">
    <link rel="stylesheet" href="../assets/css/center.css">
    <link rel="stylesheet" href="../assets/css/public.css">
    <link rel="stylesheet" href="../assets/css/home.css">
</head>

<body style="background-color: #eee;" class="am-with-fixed-header  am-with-fixed-navbar">
    <div ng-view id="myAPP"></div>
    <!--底部-->
    <div data-am-widget="navbar" class="am-navbar am-cf am-navbar-default " id="">
        <ul id="container" class="am-navbar-nav am-cf am-avg-sm-4" style="background-color:#fff;" id="J-footer-menu">
            <li>
                <a href="index.html" class="" id="home">
                    <span id="homeIcon" class="am-icon-home footerTitleMiao headIcon"></span>
                    <span id="homeTitle" class="am-navbar-label footerTitleFont headTitle">首页</span>
                </a>
            </li>
            <li>
                <a href="catalog.html" class="" id="typelist">
                    <span id="typelistIcon" class="am-icon-bars footerTitleMiao headIcon"></span>
                    <span id="typelistTitle" class="am-navbar-label footerTitleFont headTitle">分类</span>
                </a>
            </li>
            <li>
                <a href="shopcar.html" class="" id="cart">
                    <span id="cartIcon" class="am-icon-shopping-cart footerTitleMiao headIcon" style="position:relative;">
                  <span class="am-badge am-badge-danger am-round" id="J-cart-num" 
                  style="position: absolute;top: -.2rem;left: .8rem;color: #fff;border-radius: 1000px;-webkit-text-fill-color: #fff;-webkit-text-stroke-color: #fff;font-weight: 300;display:none;">
                  0</span>
                    </span>
                    <span id="cartTitle" class="am-navbar-label footerTitleFont headTitle">购物车</span>
                </a>
            </li>
            <li>
                <a href="login.html" id="login">
                    <!-- <a id="J-hd-btn-login" href="login"> -->
                    <span id="loginIcon" class="am-icon-user footerTitleMiao headIcon"></span>
                    <span id="loginTitle" class="am-navbar-label footerTitleFont headTitle">登录</span>
                </a>
            </li>
        </ul>
    </div>
    <!--在这里编写你的代码-->
    <!--头部开始-->
    <style type="text/css">
    	.link{
    		display: block;
    	}
    </style>
    <header data-am-widget="header" class="am-header am-header-fixed  am-header-default am-no-layout">
    	<div class="am-header-left am-header-nav">
    		<a href="javasscript:;" id="index">
    			<img class="am-header-icon-custom" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMiAyMCI+PHBhdGggZD0iTTEwLDBsMiwybC04LDhsOCw4bC0yLDJMMCwxMEwxMCwweiIgZmlsbD0iI2ZmZiIvPjwvc3ZnPg=="/>
    		</a>
    	</div>
    	<h1 class="am-header-title">
    		<a href="#" class="pagename">我的地址</a>
    	</h1>
    	<div class="am-header-right am-header-nav">
    		<a href="javascript:;" class="link" id="link">
    			<i class="am-header-icon am-icon-plus "></i>
    		</a>
    	</div>
    </header>
    <script type="text/javascript">
    	
    </script>
    <!--头部结束-->
    <!--地址部分内部css样式-->
    <style type="text/css">
    	.am-list-news-default {
		    margin: 0rem;
		    background: #fff;
		    margin-top: 8px;
		}
		.am-list-news-hd {
		    padding-top: 0rem;
		    padding-bottom: .2rem;
		}
		.am-list-news-hd h2 {
		    font-size: 1.2rem;
		    font-weight: 300;
		    padding-left: .5rem;
		    color: #999;
		}
		.am-list-news-hd h2 {
		    font-size: 1.6rem;
		    float: left;
		    margin: 0;
		    height: 2rem;
		    line-height: 2rem;
		}
		.defaultaddress {
		    font-size: 1.3rem;
		    border: none;
		    background: #fff;
		    outline: none;
		}
		.am-list-news-hd .am-list-news-more {
		    font-size: 1.3rem;
		    height: 2rem;
		    line-height: 2rem;
		}
		[class*=am-icon-].am-fr {
		    margin-left: .3em;
		}
		.am-list-news-more {
		    color: #666;
		    padding-right: 1rem;
		    font-weight: 400;
		    border: none;
		    outline: none;
		    background: #fff;
		}
		.am-fr {
		    float: right;
		}
		[class*=am-icon-] {
		    display: inline-block;
		    font-style: normal;
		}
		.am-list-news-default .am-list .am-list-item-desced .am-list-item-text {
		    margin-top: .5rem;
		    color: #757575;
		}
		.am-list-news-default .am-list .am-list-item-text {
		    overflow: hidden;
		    text-overflow: ellipsis;
		    display: -webkit-box;
		    -webkit-box-orient: vertical;
		    line-height: 1.3em;
		    -webkit-line-clamp: 2;
		    max-height: 2.6em;
		}
		.am-list-item-text {
		    padding-left: 1rem;
		}
		.red{
			color: red !important;
		}
		#addr{
			background: #eee;
		}
		.boxes{
			background: white;
		}
		.shadow>.message{
			display: none;
		}
		.shadow .message-center{
    		line-height: 5rem !important;
    	}
    	.shadow .num2 .am-modal-btn{
    		width: 50%;
    		float: left;
    	}
    </style>
    <!--添加地址时所放置的区域-->
	<div data-am-widget="list_news" id="addr" class="am-list-news am-list-news-default add-conone am-no-layout">
		<!--<div class="am-list-news-hd am-cf add-contittle">				
				<h2 class="am-active">
					<button type="button" class="defaultaddress">
					<i class="j-defult-addr am-icon-check-circle am-icon-sm red">&nbsp;默认地址</i></button>
				</h2> 
				<button type="button" id="delete" onclick="delAddress('1023453')" class="am-list-news-more am-fr am-icon-trash">&nbsp;删除</button>
				
				<a href="editAddress?addressId=1023453&amp;isCarting=&amp;productItemId=&amp;quantity=">
					<button class="am-list-news-more am-fr am-icon-edit">&nbsp;编辑</button>
				</a>
		</div>
		<div class="am-list-news-bd user-addr" data-id="1023453">
			<ul class="am-list">
				<li class="am-g am-list-item-desced" style="padding-top: 0rem;">
					<a style="display: inline-block; padding-left: 1rem; color: #666; font-weight: 200;">fdsaf</a>
					<a style="display: inline-block; color: #666;">18334718255</a>
					<div class="am-list-item-text">
						<a style="font-size:13px; color: #666;">山西省 阳泉市 矿区&nbsp;北大街(03)</a>
					</div>
				</li>
			</ul>
		</div>-->
	</div>
	<!--遮罩层1-->
	<div class="shadow">
		<!--提示弹框-->
	   	<div class="message num1">
	   	  	<div class="message-top">
	   	  		消息
	   	  	</div>
	   	  	<div class="message-center">
	   	  	</div>
	   	  	<div class="message-bottom">
	   	  		<span class="am-modal-btn">确定</span>
	   	  	</div>
	   	</div>
	   	<!--确认弹框-->
	  	<div class="message num2">
		  	<div class="message-top">
		  		消息
		  	</div>
		  	<div class="message-center">
		  	</div>
		  	<div class="message-bottom">
		  		<span class="am-modal-btn">取消</span>
		  		<span class="am-modal-btn">确定</span>
		  	</div>
	  	</div>
   </div>
   <script src="../assets/js/jquery.min.js"></script>
   <script src="../assets/js/amazeui.min.js"></script>
   <script src="../assets/js/jquery.touch.js" type="text/javascript" charset="utf-8"></script>
   <script src="../assets/js/main.js"></script>
</body>
<script type="text/javascript">
//	从网址上获取用户id
	var idget=location.search.split("=")[1];
//设置跳转增加地址页面
	$("#index").attr("href","presonalcenter.html?user="+idget);
	$("#link").attr("href","addressadd.html?user="+idget);
//	建立全局变量储存删除数据是对应的数据ID
	var delnumId;
//	页面加载时获取数据库数据
	$.post("/addressget",{
		userId:idget
	},function (result) {
		for (var v of result) {
//			对获取的数据进行动态添加
			var add=`<div class="am-list-news-hd am-cf add-contittle boxes" >				
						<h2 class="am-active">
							<button type="button" class="defaultaddress  mydefault" id="${v.id}" data-name="${v.mydefault}">
							<i class="j-defult-addr am-icon-check-circle am-icon-sm ">&nbsp;默认地址</i></button>
						</h2> 
						<button type="button"  class="am-list-news-more am-fr am-icon-trash delete" data-id="${v.id}">&nbsp;删除</button>
						
						<a href="addressadd.html?change=${v.id}=${idget}">
							<button class="am-list-news-more am-fr am-icon-edit">&nbsp;编辑</button>
						</a>
					</div>
				<div class="am-list-news-bd user-addr" data-id="1023453">
					<ul class="am-list">
						<li class="am-g am-list-item-desced" style="padding-top: 0rem;">
							<a style="display: inline-block; padding-left: 1rem; color: #666; font-weight: 200;">${v.username}</a>
							<a style="display: inline-block; color: #666;">${v.mobile}</a>
							<div class="am-list-item-text">
								<a style="font-size:13px; color: #666;">${v.province} ${v.city} ${v.country}&nbsp;${v.area}(${v.postcode})</a>
							</div>
						</li>
					</ul>
				</div>`;
				$("#addr").append(add);
//				对默认数据添加样式
				$(".mydefault[data-name='1']").addClass("red");
//				对非默认数据移除样式
				$(".mydefault[data-name='0']").removeClass("red");
		}
	});
	//		删除按钮事件
	$(document).on("tap",".delete",function () {
		$(".shadow").show();
		$(".shadow>.num2").show().addClass("big");
		$(".shadow>.num2>.message-center").text("确定要删除吗");
		delnumId=$(this).attr("data-id")
	});
//		location.reload();	取消删除
	$(".num2 .am-modal-btn").eq(0).on("tap",function () {
		$(".shadow>.num2").removeClass("big");
		$(".shadow>.num2").addClass("small");
		setTimeout(function () {
			$(".shadow>.num2").removeClass("small").hide();
//					确认取消提示
			$(".shadow>.num1").show().addClass("big");
			$(".shadow>.num1>.message-center").text("已取消！");
		},300);

//				确定取消事件
		$(".num1 .am-modal-btn").on("tap",function () {
			$(".shadow>.num1").removeClass("big");
			$(".shadow>.num1").addClass("small");
			setTimeout(function () {
				$(".shadow").hide();
				$(".shadow>.num1").removeClass("small").hide();
			},300);
		});
	});
//			确认删除
	$(".num2 .am-modal-btn").eq(1).on("tap",function () {
		$(".shadow>.num2").removeClass("big");
		$(".shadow>.num2").addClass("small");
		setTimeout(function () {
			$(".shadow>.num2").removeClass("small").hide();
//			删除成功提示
			$(".shadow>.num1").show().addClass("big");
			$(".shadow>.num1>.message-center").text("删除成功！");
		},300);

//				确定取消事件
		$(".num1 .am-modal-btn").on("tap",function () {
			$(".shadow>.num1").removeClass("big");
			$(".shadow>.num1").addClass("small");
			
			setTimeout(function () {
				$(".shadow").hide();
				$(".shadow>.num1").removeClass("small").hide();
//				传回数据库,删除对应的数据
				$.post("/addressdel",{addId:delnumId},function (result) {
					if (result=="success") {
						location.reload();
					}
				})
			},300);
		});
	});
//			默认设置
//	事件委托绑定默认按钮
	$(document).on("tap",".mydefault",function () {
//		点击时添加样式
		$(this).addClass("red").parents(".boxes").siblings(".boxes").find(".mydefault").removeClass("red");
//		获取要设置为默认的地址id
		var changid=$(this).attr("id");
//		修改当前用户下所有的地址默认值为非默认
		$.post("/addressunDefaulchange",{undefnum:0,userId:idget},function (result) {
			if (result=="success") {
//				成果后进行当前默认设置
				$.post("/addressDefaulchange",{changId:changid,defnum:1},function (result) {
					if (result=="success") {
//						成功后弹窗,并延时刷新页面
						$(".shadow").show();
						$(".shadow>.num1").show().addClass("big");
						$(".shadow>.num1>.message-center").text("设置为默认");
						
						setTimeout(function () {
							location.reload()
						},500);
					}
				});
			}
		});
	});
//	设置遮罩层宽高
	$(".shadow").height($(document).height());
</script>
</html>