<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="加意新品(jiae.com)是一种创意的生活方式，让每个人享受设计的乐趣，每天加一点创意。 对于消费者，你可以抢鲜购买到原创的设计精品，也可以找到设计师为你提供专属的创意设计服务。 对于设计师，你可以免费发布设计新品和设计服务，帮助你自由实现设计梦想。">
    <meta name="keywords" content="创意电商、新品电商、创意产品、创意家居、创意设计、创意礼物、创意生活、设计师、极客">
    <meta name="viewport" content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no,minimal-ui">
    <title>加意新品</title>
    <!-- Set render engine for 360 browser -->
    <meta name="renderer" content="webkit">
    <!-- No Baidu Siteapp-->
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="shortcut icon" href="../assets/i/favicon.ico">
    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" sizes="192x192" href="../assets/i/app-icon72x72@2x.png">
    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Amaze UI" />
    <link rel="apple-touch-icon-precomposed" href="../assets/i/app-icon72x72@2x.png">
    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="../assets/i/app-icon72x72@2x.png">
    <meta name="msapplication-TileColor" content="#0e90d2">
    <link rel="stylesheet" href="../assets/css/amazeui.min.css">
    <link rel="stylesheet" href="../assets/css/app.css">
    <link rel="stylesheet" href="../assets/css/public.css">
    <link rel="stylesheet" href="../assets/css/home.css">
    <script src="../assets/js/jquery.min.js"></script>
    <script src="../assets/js/amazeui.min.js"></script>
    <script src="../assets/js/main.js"></script>
    <script src="../assets/js/jquery.lazyload.js" type="text/javascript" charset="utf-8"></script>
</head>

<body style="background-color: #fff;" class="am-with-fixed-header am-with-fixed-navbar">
    <div ng-view id="myAPP"></div>
    <!--底部-->
    <div data-am-widget="navbar" class="am-navbar am-cf am-navbar-default " id="">
        <ul id="container" class="am-navbar-nav am-cf am-avg-sm-4" style="background-color:#fff;" id="J-footer-menu">
            <li>
                <a href="index.html" class="" id="home">
                    <span id="homeIcon" class="am-icon-home footerTitleMiao  headIcon"></span>
                    <span id="homeTitle" class="am-navbar-label footerTitleFont headTitle">首页</span>
                </a>
            </li>
            <li>
                <a href="catalog.html" class="" id="typelist">
                    <span id="typelistIcon" class="am-icon-bars footerTitleMiao footerTitleMiaoActive headIcon"></span>
                    <span id="typelistTitle" class="am-navbar-label footerTitleFont footerTitleFontActive headTitle">分类</span>
                </a>
            </li>
            <li>
                <a href="shopcar.html" class="" id="cart">
                    <span id="cartIcon" class="am-icon-shopping-cart footerTitleMiao headIcon" style="position:relative;">
                  <span class="am-badge am-badge-danger am-round" id="J-cart-num" 
                  style="position: absolute;top: -.2rem;left: .8rem;color: #fff;border-radius: 1000px;-webkit-text-fill-color: #fff;-webkit-text-stroke-color: #fff;font-weight: 300;display:none;">
                  0</span>
                    </span>
                    <span id="cartTitle" class="am-navbar-label footerTitleFont headTitle">购物车</span>
                </a>
            </li>
            <li>
                <a href="javascript:;" id="login">
                    <!-- <a id="J-hd-btn-login" href="login"> -->
                    <span id="loginIcon" class="am-icon-user footerTitleMiao headIcon"></span>
                    <span id="loginTitle" class="am-navbar-label footerTitleFont headTitle">登录</span>
                </a>
            </li>
        </ul>
    </div>
    <!--在这里编写你的代码-->
    <style type="text/css">
        .am-icon-sm:before {
            font-size: 150%;
            vertical-align: -10%;
        }
        
        .list {
            margin: 5px;
        }
        
        .j-pro-list {
            position: relative;
        }
        
        .am-g {
            margin: 0 auto;
            width: 100%;
        }
        
        [class*=am-u-] {
            /*width: 100%;*/
            /*padding-left: 1rem;
			    padding-right: 1rem;*/
            float: left;
            position: relative;
        }
        
        .am-u-sm-9-div {
            /* height: 7rem; */
            width: 75%;
            padding: 0rem;
        }
        
        a {
            color: #333;
        }
        
        .list-img {
            width: 7rem;
            height: 7rem;
        }
        
        .list-img img {
            width: 7rem;
            height: 7rem;
        }
        
        .am-g .am-g {
            margin-left: 0px;
            margin-right: 0px;
            width: auto;
        }
        
        .am-text-default {
            font-weight: 200;
            overflow: hidden;
            white-space: nowrap;
            display: block;
        }
        
        .am-text-sm {
            font-weight: 200;
            color: #bdbdbd;
        }
        
        .am-g {
            margin-right: 0px;
            margin-bottom: 1px;
        }
        
        .price {
            color: #ff0000;
            font-weight: 400;
        }
        
        .productShopping {
            background-color: rgba(186, 186, 186, 0.5);
            position: absolute;
            bottom: 30%;
            right: 5%;
            color: #f0f1f0;
            top: 30px;
            left: 87%;
            width: 30px;
            height: 30px;
            font-size: 14px;
            line-height: 30px;
        }
    </style>
    
    <!--副页面的头部-->
    <header class="am-header am-header-default am-header-fixed am-no-layout">
        <div class="am-header-left am-header-nav">
            <a href="javascript:window.history.back();" class="">
                <i class="am-header-icon am-icon-angle-left am-icon-sm">
    				</i>
            </a>
        </div>
        <h1 class="am-header-title headTitle" id="search">
            商品列表
        </h1>
    </header>
    <!--动态加载的商品列表-->
    <div class="list">
        <div class="mp am-g j-pro-list">
        	<!--商品图片-->
            <div class="am-u-sm-3 am-list-thumb ggds" data-id="" style="padding: 0;">
                <a href="javascript:;" class="list-img">
                    <img class="am-img-thumbnail am-radius lazy" data-original="" src="" alt="" />
                </a>
            </div>
            <!--商品信息(价格，名字)-->
            <div class="am-u-sm-9-div tiles" data-id="">
                <a href="javascript:;" class="list-img">
                    <div class="am-g productDetail">
                        <div class="am-u-sm-9-desc">
                            <span class="am-text-default w1"></span>
                        </div>
                    </div>
                    <div class="am-g productBrand">
                        <div class="am-u-sm-9">
                            <span class="am-text-sm w2"></span>
                        </div>
                    </div>
                    <div class="am-g productPrice">
                        <div class="am-u-sm-9">
                            <span class="price"></span>
                        </div>
                    </div>
                    <div class="am-g line">
                        <div class="am-u-sm-9-line">
                            <hr style="margin:0px;bottom:0px;">
                        </div>
                    </div>
                </a>
            </div>
            <a href="javascript:;" class="am-icon-btn am-icon-shopping-cart productShopping am-icon-sm j-btn-catalog"></a>
        </div>
    </div>
<!--遮罩层，弹框-->
    <div id="zzc" class="am-dimmer am-active" data-am-dimmer="" style="display: none;"></div>
    <div id="alert" class="am-modal am-modal-alert am-modal-active" tabindex="-1" id="jiae-alert" style="display: none; margin-top: -66px;">
        <div class="am-modal-dialog">
            <div class="am-modal-hd">消息</div>
            <div class="am-modal-bd" id="alertMsg">加入购物车成功！</div>
            <div class="am-modal-footer">
                <span class="am-modal-btn" id="sure">确定</span>
            </div>
        </div>
    </div>

    <script type="text/javascript">
    	if (sessionStorage.username) {
				$("#loginTitle").text("个人中心");
				$("#login").on("click",function () {
					location.href="presonalcenter.html";
				});
			}else{
				$("#login").on("click",function () {
					location.href="login.html";
				});
				$("#loginTitle").text("登录");
//				location.href="login.html";
			}
    	//获取前边传递过来的value值，及点击的index
        var b = localStorage.getItem("search"),
            s = localStorage.getItem("tyid");
        //点击分类图标默认就点击第一个分类
        $('#typelist').click(function() {
            //localStorage.removeItem("act");
            $('#catalog').children('li').eq(0).trigger('click');
        });

        $('body').ready(function() {
            $.get("/classify", function(result) {
                //console.log(result);
                var pics = [],
                    tl = [],
                    pic = [],
                    bd = [],data_id=[];
                $.each(result, function(index, item) {
//              	console.log(result);
                    if (s == item.type_id - 1) {
                        $('.mp:first').clone(true).appendTo('.list');
                        data_id.push(item.id);
                        pics.push(item.pic1);
                        tl.push(item.title);
                        pic.push(item.price);
                        bd.push(item.name);
                    }
                });
//              console.log(data_id);
                $('.mp:last').remove();
                for (var i = 0; i < pics.length; i++) {
                    $('.mp img').eq(i).attr('src', "../assets/i/shoping-img/" + pics[i] + ".jpg");
                    $('.mp img').eq(i).attr('data-original', "../assets/i/shoping-img/" + pics[i] + ".jpg");
                    $('.ggds').eq(i).attr('data-id',data_id[i]);
                    $('.tiles').eq(i).attr('data-id',data_id[i]);
                    $('.mp .w1').eq(i).text(tl[i]);
                    $('.mp .w2').eq(i).text(bd[i]);
                    $('.mp .price').eq(i).text("￥" + pic[i] + ".00");
                   
                }
                //图片懒加载
				$("img.lazy").lazyload({
				   load:function() { 
						$(this).css('opacity', 0).animate({'opacity':1},1500);
					}
				 });
				//传递点击商品的goods_id

					$(document).on("click",".ggds,.tiles",function(){
				      		
//				      		console.log($(this).attr('data-id'));
				      		var gdsid=$(this).attr('data-id');
//				      		console.log($(this).attr('data-id'));
				      		location.href="goods.html?gdsid="+ gdsid;
//				      		location.replace("goods.html?gdsid=" + gdsid);
					})

            });
        });

		
		 
		
		//添加购物车
        $('#sure').click(function() {
            $('#zzc').hide();
            $('#alert').hide();
        });
        var add = 1;
        var gss, prc = 0;
        
        //d点击分类获取商品及信息
        $('.productShopping').click(function() {
            $('#J-cart-num').text(add++).show();
            txt = $(this).prev().find('.w1').text();
            console.log(txt);
            prc = $(this).prev().find('.price').text();
            prc = prc.split('￥')[1];
            console.log(prc);
            //获取id
            $.get("/goods_type_id", function(result) {
                $.each(result, function(index, item) {
                    if (txt == item.title) {
                        gss = item.id;
                        
                    }
                });
                //传递点击商品信息到shopcart数据库中
        		$.post("/shopcart", {
		                    gsid: gss,
		                    usid: 1,
		                    cnt: 1,
		                    sprice: prc,
		                    price: prc
	                	}, function(result) {
	                    if (result == true) {
	                        $('#zzc').show();
	                        $('#alert').show();
	                    }
	                });


            });

        })
    </script>


</body>

</html>