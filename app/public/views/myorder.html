<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="加意新品(jiae.com)是一种创意的生活方式，让每个人享受设计的乐趣，每天加一点创意。 对于消费者，你可以抢鲜购买到原创的设计精品，也可以找到设计师为你提供专属的创意设计服务。 对于设计师，你可以免费发布设计新品和设计服务，帮助你自由实现设计梦想。">
    <meta name="keywords" content="创意电商、新品电商、创意产品、创意家居、创意设计、创意礼物、创意生活、设计师、极客">
    <meta name="viewport" content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no,minimal-ui">
    <title>加意新品</title>
    <!-- Set render engine for 360 browser -->
    <meta name="renderer" content="webkit">
    <!-- No Baidu Siteapp-->
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="shortcut icon" href="../assets/i/favicon.ico">
    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" sizes="192x192" href="../assets/i/app-icon72x72@2x.png">
    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Amaze UI" />
    <link rel="apple-touch-icon-precomposed" href="../assets/i/app-icon72x72@2x.png">
    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="../assets/i/app-icon72x72@2x.png">
    <meta name="msapplication-TileColor" content="#0e90d2">
    <link rel="stylesheet" href="../assets/css/amazeui.min.css">
    <link rel="stylesheet" href="../assets/css/center.css">
    <link rel="stylesheet" href="../assets/css/public.css">
    <link rel="stylesheet" href="../assets/css/home.css">
</head>

<body style="background-color: white;" class="am-with-fixed-header  am-with-fixed-navbar">
    <div ng-view id="myAPP"></div>
    <!--底部-->
    <div data-am-widget="navbar" class="am-navbar am-cf am-navbar-default " id="">
        <ul id="container" class="am-navbar-nav am-cf am-avg-sm-4" style="background-color:#fff;" id="J-footer-menu">
            <li>
                <a href="index.html" class="" id="home">
                    <span id="homeIcon" class="am-icon-home footerTitleMiao footerTitleMiaoActive headIcon"></span>
                    <span id="homeTitle" class="am-navbar-label footerTitleFont footerTitleFontActive headTitle">首页</span>
                </a>
            </li>
            <li>
                <a href="catalog.html" class="" id="typelist">
                    <span id="typelistIcon" class="am-icon-bars footerTitleMiao headIcon"></span>
                    <span id="typelistTitle" class="am-navbar-label footerTitleFont headTitle">分类</span>
                </a>
            </li>
            <li>
                <a href="shopcar.html" class="" id="cart">
                    <span id="cartIcon" class="am-icon-shopping-cart footerTitleMiao headIcon" style="position:relative;">
                  <span class="am-badge am-badge-danger am-round" id="J-cart-num" 
                  style="position: absolute;top: -.2rem;left: .8rem;color: #fff;border-radius: 1000px;-webkit-text-fill-color: #fff;-webkit-text-stroke-color: #fff;font-weight: 300;display:none;">
                  0</span>
                    </span>
                    <span id="cartTitle" class="am-navbar-label footerTitleFont headTitle">购物车</span>
                </a>
            </li>
            <li>
                <a href="login.html" id="login">
                    <!-- <a id="J-hd-btn-login" href="login"> -->
                    <span id="loginIcon" class="am-icon-user footerTitleMiao headIcon"></span>
                    <span id="loginTitle" class="am-navbar-label footerTitleFont headTitle">登录</span>
                </a>
            </li>
        </ul>
    </div>
    <!--在这里编写你的代码-->
    <!--头部开始-->
    <style type="text/css">
    	.link{
    		display: block;
    	}
    </style>
    <header data-am-widget="header" class="am-header am-header-fixed  am-header-default am-no-layout">
    	<div class="am-header-left am-header-nav">
    		<a href="javascript:window.history.back();" class>
    			<img class="am-header-icon-custom" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMiAyMCI+PHBhdGggZD0iTTEwLDBsMiwybC04LDhsOCw4bC0yLDJMMCwxMEwxMCwweiIgZmlsbD0iI2ZmZiIvPjwvc3ZnPg=="/>
    		</a>
    	</div>
    	<h1 class="am-header-title">
    		<a href="#" class="pagename">我的订单</a>
    	</h1>
    	<div class="am-header-right am-header-nav">
    		<a href="presonalcenter.html" id="link">
    			<i class="am-header-icon am-icon-cog "></i>
    		</a>
    	</div>
    </header>
    <!--头部结束-->
    <style type="text/css">
    	.productPanelTitle{
    		height: 0;
    	}
    	.am-tab-panel{
    		padding: 0 !important;
    	}
    	.am-panel-default{
    		border: none;
    	}
    	.am-img-thumbnail {
		    display: inline-block;
		    max-width: 100%;
		    height: auto;
		    padding: 2px;
		    line-height: 1.6;
		    background-color: #fff;
		    /*border: 1px solid #ddd;*/
		    border-radius: 0;
		    -webkit-transition: all .2s ease-in-out;
		    transition: all .2s ease-in-out;
		}
		.btnSpan {
		    position: relative;
		    right: -1rem;
		}
		.shadow>.message{
			display: none;
		}
		.shadow .message-center{
    		line-height: 2rem !important;
    	}
    	.shadow .num2 .am-modal-btn{
    		width: 50%;
    		float: left;
    	}
    </style>
    <!--我的订单页面框-->
	<div data-am-widget="tabs" class="am-tabs am-tabs-default am-no-layout">
		<!--选项卡头部-->
		<ul class="am-tabs-nav am-cf am-margin-xs am-text-sm listmove">
			<li id="tab-panel-1" class="am-active">
				<a href="[data-tab-panel-1]" >待付款</a>
			</li>
			<li id="tab-panel-2" class="">
				<a href="[data-tab-panel-2]" >进行中</a>
			</li>
			<li id="tab-panel-3" class="">
				<a href="[data-tab-panel-3]" >已完成</a>
			</li>
		</ul>
		<div class="am-tabs-bd" style="touch-action: pan-y; user-select: none; -webkit-user-drag: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
			<!--第一个未完成添加的位置-->
			<div data-tab-panel-1="" class="am-tab-panel am-active boxess" id="data-tab-panel-1"></div>
		    <!--进行中添加的位置-->
			<div data-tab-panel-2="" class="am-tab-panel " id="data-tab-panel-2"></div>
			<!--已完成添加的位置-->
			<div data-tab-panel-3="" class="am-tab-panel " id="data-tab-panel-3"></div>
		</div>
		
	</div>
<!--遮罩层1-->
	<div class="shadow">
	  	<div class="message num2">
		  	<div class="message-top">
		  		消息
		  	</div>
		  	<div class="message-center">
		  	</div>
		  	<div class="message-bottom">
		  		<span class="am-modal-btn">取消</span>
		  		<span class="am-modal-btn">确定</span>
		  	</div>
	  	</div>
   </div>
   <script src="../assets/js/jquery.min.js"></script>
   <script src="../assets/js/amazeui.min.js"></script>
   <script src="../assets/js/jquery.touch.js" type="text/javascript" charset="utf-8"></script>
   <script src="../assets/js/main.js"></script>
</body>
<script type="text/javascript">
//	遮罩层宽高设置
	$(".shadow").height($(document).height());
//	获取用户id
	var idget=location.search.split("=")[1];
	$("#link").attr("href","presonalcenter.html?user="+idget);
//	对用户订单信息进行调用
	$.post("/orderget",{userId:idget},function (result) {
		for (var v of result) {
			var boxxx=`<div class="am-panel am-panel-default" style="margin-top:-21px;">
								<div class="am-panel-hd productPanelTitle"></div>
					    			<div class="am-panel-bd">
			          					<div class="orders">
			                				<div class="am-g am-g-collapse am-text-xs">
			                					<div class="am-u-sm-8 am-u-md-8 am-u-lg-9 ">
			                    					<span class="am-fl  ">订单号：${v.id}</span>
			                    				</div>
							                    <div class="am-u-sm-4 am-u-md-4 am-u-lg-3 ">
							                    	<span class="am-text-danger am-text-sm  am-fr">商品已确认</span>
							                    </div>
			                				</div>
			                			<hr style="margin: 0.3rem;">
						                <div class="am-g">
						                    <div class="am-u-sm-3 am-list-thumb am-text-xs" style="padding:0px;">
						                        <a href="javascript:;" class="">
						                        	<img class="am-img-thumbnail am-radius lazy" src="../assets/i/shoping-img/${v.pic1}.jpg" alt="${v.title}">
						                        </a>
						                	</div>
						                    <div class="am-u-sm-9 am-g-collapse am-text-xs" style="padding:0 5%;">
						                        <div class="am-g goodDetail">
						                        	<div class="am-u-sm-7 am-margin-left-sm" style="width:70%;">  
						                         		<span>${v.title}</span>
						                        	</div>
						                       	 	<div class="am-u-sm-2 " style="width:20%;">  
							                         	<span class="am-icon-cny" style="float:right;margin-right:1rem;">${v.singlePrice}</span>
							                        </div>
							                    </div>
							                    <div class="am-g goodBrand">
							                        <div class="am-u-sm-9 am-margin-right-sm  am-fr">  
							                         	<span class="am-icon-times am-fr">${v.count}</span>
							                        </div>
							                    </div>
							                    <div class="am-g goodBrand">
							                     	<div class="am-u-sm-9 am-margin-right-sm  am-fr"></div>
							                    </div>
							                </div>
			            				</div>
							            <div class="am-g orderAmount am-g-collapse">
							                <div class="am-u-sm am-fr">
							               		<span class="am-text-xs am-fr  ">共计${v.count}.00件  合计￥${v.price}</span> 
							                </div>
							            </div>
							            <div class="am-g orderAction ">
							                <div class="am-u-sm ">
								                <span class="am-text-xs btnSpan am-fr" style="width:19rem">
								               		<div class="am-fr">
										                <a class="am-btn am-btn-danger am-text-xs am-radius dele" style="padding: 0.7rem;border-radius: 0px;width:6.5rem;" href="javascript:;" data-id="${v.id}">取消订单</a>       
										                <a class="am-btn am-btn-danger am-text-xs am-radius" style="padding: 0.7rem;border-radius: 0px;width:6.5rem;" href="javascript:;">付  款</a>       
								                    </div>
								                </span>
							                </div>
							            </div>
				        			</div>
				  				</div> 
					    	</div>       
						</div>`;
			$(".boxess").append(boxxx);
		}
		
	});
//	建立全局变量储存对应的订单信息id
	var oId;
//	事件委托获取删除按钮并绑定事件
	$(document).on("tap",".dele",function () {
		oId=$(this).attr("data-id");
		$(".shadow").show();
		$(".shadow>.num2").show().addClass("big");
		$(".shadow>.num2>.message-center").text("确认要取消订单吗？订单取消后将不可恢复。");
	});
//	取消删除事件
	$(".num2 .am-modal-btn").eq(0).on("tap",function (){
		$(".shadow>.num2").removeClass("big");
		$(".shadow>.num2").addClass("small");
		setTimeout(function () {
			$(".shadow>.num2").removeClass("small").hide();
			$(".shadow").hide();
		},300);
	})
//	确认删除事件
	$(".num2 .am-modal-btn").eq(1).on("tap",function (){
		$(".shadow>.num2").removeClass("big");
		$(".shadow>.num2").addClass("small");
		setTimeout(function () {
			$(".shadow>.num2").removeClass("small").hide();
			$(".shadow").hide();
		},300);
//		向数据库发送请求来删除数据
		$.post("/orderDelete",{orderId:oId},function (result) {
			if (result=="success") {
				location.reload();
			}
		});
	})
</script>
</html>