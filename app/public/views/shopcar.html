<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="加意新品(jiae.com)是一种创意的生活方式，让每个人享受设计的乐趣，每天加一点创意。 对于消费者，你可以抢鲜购买到原创的设计精品，也可以找到设计师为你提供专属的创意设计服务。 对于设计师，你可以免费发布设计新品和设计服务，帮助你自由实现设计梦想。">
    <meta name="keywords" content="创意电商、新品电商、创意产品、创意家居、创意设计、创意礼物、创意生活、设计师、极客">
    <meta name="viewport" content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no,minimal-ui">
    <title>加意新品</title>
    <!-- Set render engine for 360 browser -->
    <meta name="renderer" content="webkit">
    <!-- No Baidu Siteapp-->
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="shortcut icon" href="../assets/i/favicon.ico">
    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" sizes="192x192" href="../assets/i/app-icon72x72@2x.png">
    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Amaze UI" />
    <link rel="apple-touch-icon-precomposed" href="../assets/i/app-icon72x72@2x.png">
    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="../assets/i/app-icon72x72@2x.png">
    <meta name="msapplication-TileColor" content="#0e90d2">
    <link rel="stylesheet" href="../assets/css/amazeui.min.css">
    <link rel="stylesheet" href="../assets/css/shop.css">
    <link rel="stylesheet" href="../assets/css/public.css">
    <link rel="stylesheet" href="../assets/css/home.css">
    <link rel="stylesheet" href="../assets/css/sweetalert.css" />
</head>

<body style="background-color: #f5f5f5;" class="am-with-fixed-header">
    <div ng-view id="myAPP"></div>
    <!--底部-->
    <!--<div data-am-widget="navbar" class="am-navbar am-cf am-navbar-default " id="">
        <ul id="container" class="am-navbar-nav am-cf am-avg-sm-4" style="background-color:#fff;" id="J-footer-menu">
            <li>
                <a href="#/home" class="" id="home">
                    <span id="homeIcon" class="am-icon-home footerTitleMiao headIcon"></span>
                    <span id="homeTitle" class="am-navbar-label footerTitleFont headTitle">首页</span>
                </a>
            </li>
            <li>
                <a href="#/typelist" class="" id="typelist">
                    <span id="typelistIcon" class="am-icon-bars footerTitleMiao headIcon"></span>
                    <span id="typelistTitle" class="am-navbar-label footerTitleFont headTitle">分类</span>
                </a>
            </li>
            <li>
                <a href="#/basket" class="" id="cart">
                    <span id="cartIcon" class="am-icon-shopping-cart footerTitleMiao headIcon" style="position:relative;">
                  <span class="am-badge am-badge-danger am-round" id="J-cart-num" 
                  style="position: absolute;top: -.2rem;left: .8rem;color: #fff;border-radius: 1000px;-webkit-text-fill-color: #fff;-webkit-text-stroke-color: #fff;font-weight: 300;display:none;">
                  0</span>
                    </span>
                    <span id="cartTitle" class="am-navbar-label footerTitleFont headTitle">购物车</span>
                </a>
            </li>
            <li>
                <a href="#/login" id="login">
                    <!-- <a id="J-hd-btn-login" href="login"> -->
                    <!--<span id="loginIcon" class="am-icon-user footerTitleMiao footerTitleMiaoActive headIcon"></span>
                    <span id="loginTitle" class="am-navbar-label footerTitleFont footerTitleFontActive headTitle">登录</span>
                </a>
            </li>
        </ul>
    </div>-->
    <!--在这里编写你的代码-->
    <!--购物车顶部内容-->
    <header data-am-widget="header" class="am-header am-header-default am-header-fixed am-no-layout">
        <div class="am-header-left am-header-nav">
            <a href="javascript:window.history.back()" class>
                <img class="am-header-icon-custom" src='data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 20"><path d="M10,0l2,2l-8,8l8,8l-2,2L0,10L10,0z" fill="%23fff"/></svg>'/>
            </a>
        </div>
        <h1 class="am-header-title">
            <a href="#" class>购物车</a>
        </h1>
        <div class="am-header-right am-header-nav">
            <a href="javascript:;" class="j-my-icon" id="pre-cen">
            	<i class="am-header-icon am-icon-cog"></i>
            </a>
        </div>
    </header>
    <!--空购物车界面-->
    <div class="J-content-cart" id="J-content-cart1" style="display:none;">
    	<div class="cart" style="background-color:#f5f5f5">
    		<div class="cart-empty" style="padding-top:5%">
    			<p>
    				<img src="../assets/i/shopcart.png"/>
    				<br/>
    				<br/>
    				您的购物车还是空的，赶紧行动！
    			</p>
    			<a class="btn btn-shopping" href="index.html">去逛逛</a>
    		</div>
    	</div>
    </div>
    <!--购物车商品信息加载界面-->
    <div class="J-content-cart" id="J-content-cart2">
    	<div class="cart">
    		<form action="." class="form-cart" method="post" id="J-form-cart">
    				<ul class="uList cart-list" id="J-item-lists">
    				<div class="am-g J-item-list">
    					<div class="am-u-sm-3 am-list-thumb am-text-xs">
    						<a href="#">
    							<img id="img" class="am-img-thumbnail am-radius" src="" alt="">
    						</a>
    					</div>
    					<div class="am-u-sm-9 am-g-collapse am-text-xs" id="di">
    						<div class="am-g goodDetail">
    							<!--商品的标题信息-->
    							<div class="am-u-sm-7 am-margin-left-sm">
    								<span id="wen"></span>
    							</div>
    						</div>
    						<div class="am-g goodDetail">
    							<div class="am-u-sm-7 am-margin-left-sm">
    								<span></span>
    							</div>
    						</div>
    						<div class="am-g goodBrand" id="fu">
    							<!--商品的单价信息-->
    							<div class="am-u-sm-3 am-margin-left-sm">
    								<span class="am-icon-cny" id="sigpri"></span>
    							</div>
    							<div class="am-u-sm-9 am-margin-right-sm am-fr">
    								<div class="shoppingCartItemnum">
    									<!--商品数量的增减-->
    									<span class="col-xs-4 col-sm-4 col-md-4 tcenter">
    										<span class="am-icon-minus-circle am-icon-sm J-btn-minus minus"></span>
    											<input class="inputtype J-item-quantity" name="name_quantity" type="text" value="1">
    										<span class="am-icon-plus-circle am-icon-sm J-btn-add plus"></span>
    									</span>
    								</div>
    							</div>
    						</div>
    					</div>
    					<!--删除按钮-->
    					<a href="#" class="trash">
    						<i id="clear" class="fa fa-trash J-btn-del"></i>
    					</a>
    				</div>
    			</ul>
    		</form>
    		<div class="foot">
    			<div class="leftdesc">
    				<div class="priceadd">
    					<p id="zhi" class="curprice" align="left"></p>
    				</div>
    			</div>
    			<div class="addtxt">
     				<a href="#">去结算</a>
    			</div>
    		</div>
    	</div>
    </div>
    <!--消息弹框-->
    <div class="am-modal am-modal-confirm" tabindex="-1" id="jiae" style="display:none;margin-top:-53px;">
    	<div class="am-modal-dialog">
    		<div class="am-modal-hd" id="confirmTitle1">确定要删除吗？</div>
    		<div class="am-modal-bd" id="confirmMsg1"></div>
    		<div class="am-modal-footer">
    			<span class="am-modal-btn" id="qu" data-am-modal-cancel>取消</span>
    			<span class="am-modal-btn" id="que" data-am-modal-confirm>确定</span>
    		</div>
    	</div>
    </div>
    <!--遮罩层-->
    <div id="mask" class="am-dimmer" data-am-dimmer style="display:none"></div>
   <script src="../assets/js/jquery.min.js"></script>
   <script src="../assets/js/amazeui.min.js"></script>
   <script src="../assets/js/main.js"></script>
   <script type="text/javascript" src="../assets/js/sweetalert.min.js" ></script>
   <script type="text/javascript">
   		var $minus=$('.minus'),$plus=$('.plus'),y=1,x=1,arr=[],crr=[],iNow;
   		var $inp=$('input[name="name_quantity"]'),$zhi=$('#zhi'),ss;
   		var $img=$('#img'),$wen=$('#wen'),$sigpri=$('#sigpri'),$ul=$('#J-item-lists'),$form=$('#J-form-cart');
   		var $cle=$('#clear'),yy,heji=0,$que=$('#que'),tt;
   		/*删除商品时时的弹框的显示与隐藏*/
   		$cle.click(function(){
   			$('#jiae').addClass('am-modal-active').fadeIn();
   			$('#mask').addClass('am-active').fadeIn();
   			tt=$(this).parent().siblings('#di').find('#wen').text()
   		});
   		$('#mask').click(function(){
   			$('#jiae').removeClass('am-modal-active').fadeOut();
   			$('#mask').removeClass('am-active').fadeOut();
   		});
   		$('#qu').click(function(){
   			$('#jiae').removeClass('am-modal-active').fadeOut();
   			$('#mask').removeClass('am-active').fadeOut();
   		});
   		
   		//跳转到个人中心
   		$('#pre-cen').click(function(){
   			if(sessionStorage.getItem('username') == null){
   				location.href="login.html";
   			}else{
   				location.href="presonalcenter.html";
   			}
   		});
   		/*将商品信息从数据库中彻底删掉*/
   		$que.click(function(){
   			$.post('/clear',{tle:tt},function(result){
   				gid=result[0].id;
   				$.post('/cla',{id:gid},function(result){
   					if(result=='success'){
   						$('#jiae').removeClass('am-modal-active').fadeOut();
   						$('#mask').removeClass('am-active').fadeOut();
   						location.reload();
   					}
   				});
   			});
   		});
   		var tle=[],pic=[],spc=[],num;
   		/*从数据库shopcart中获取商品信息,并加载带页面上*/
   		$('body').ready(function(){
   			$.get("/shopcart",function(result){
   				if(result.length>0){
	   				for(var i=0;i<result.length;i++){
	   					$ul.clone(true).appendTo($form);
	   					$img.attr('src','../assets/shoping-img/' + result[i].pic1 +'.jpg');
	   					$img.attr('alt',+ result[i].title);
	   					$wen.text(result[i].title);
	   					$sigpri.text(result[i].SinglePrice + ".00");
	   					$minus.attr('id','minus' + result[i].goods_id);
	   					$plus.attr('id','plus' + result[i].goods_id);
	   					$inp.attr('id','ipt' + result[i].goods_id);
	   					arr.push('#'+$('#minus'+result[i].goods_id).attr('id'));
	   					crr.push('#'+$('#plus'+result[i].goods_id).attr('id'))
	   					heji+=result[i].SinglePrice*result[i].count;
						$zhi.text('合计：' + heji + '元');
						$inp.val(result[i].count);
	   				};
	   				/*购物车数量的删减，并上传回数据库*/
	   				for(var i=0;i<arr.length;i++){
	   					var iNow2=$(arr[0]).attr('id');
	   					$(arr[i]).click(function(){
	   						iNow=$(this).attr('id');
	   						if(iNow2==iPre){
	   							y=$(this).parent().find('input[name="name_quantity"]').val();
	   							y--;
	   							if(y<1){
	   								y=1;
	   								return;
	   							};
	   							$(this).parent().find('input[name="name_quantity"]').val(y);
	   						}else{
	   							y=$(this).parent().find('input[name="name_quantity"]').val()-1;
	   							if(y<1){
	   								y=1;
	   								return;
	   							};
	   							$(this).parent().find('input[name="name_quantity"]').val(y);
	   						};
	   						ss=parseInt($(this).parents('#fu').find('#sigpri').text());
	   						heji-=ss;
	   						$zhi.text('合计：' + heji + '元');
	   						$.post('/count',{
	   							sp:ss
	   						},function(result){
	   							yy=result[0].count-1;
	   							zp=ss*yy;
	   							$.post('/sum',{
	   								sps:ss,
	   								sum:yy,
	   								zpr:zp
	   							},function(result){});
	   						});
	   						iPre=$(this).attr('id');
	   					});
	   				};
	   				/*购物车商品数量的添加,并上传到数据库中*/
	   				for(var i=0;i<crr.length;i++){
	   					var iPre=$(crr[0]).attr('id');
	   					$(crr[i]).click(function(){
	   						iNow1=$(this).attr('id');
	   						if(iNow1==iPre){
	   							x=$(this).parent().find('input[name="name_quantity"]').val();
	   							x++;
	   							$(this).parent().find('input[name="name_quantity"]').val(x);
	   						}else{
	   							x=parseInt($(this).parent().find('input[name="name_quantity"]').val())+1;
	   							$(this).parent().find('input[name="name_quantity"]').val(x);
	   						}
	   						ss=parseInt($(this).parents('#fu').find('#sigpri').text());
	   						x=parseInt($(this).parent().find('input[name="name_quantity"]').val());
	   						heji+=ss;
	   						$zhi.text('合计：' + heji + '元');
	   						$.post('/count',{
	   							sp:ss
	   						},function(result){
	   							yy=result[0].count+1;
	   							zp=ss*yy;
	   							$.post('/sum',{
	   								sps:ss,
	   								sum:yy,
	   								zpr:zp
	   							},function(result){});
	   						});
	   						iPre=$(this).attr('id');
	   					});
	   				};
	   				$form.children('ul:eq(1)').remove();
	   				$form.children('ul:eq(0)').clone(true).appendTo($form);
	   				$form.children('ul:eq(0)').remove();
		   		}else{
		   			$('#J-content-cart1').show().siblings('#J-content-cart2').hide();
		   		};
		   	});
		})
   		
   </script>
</body>
</html>